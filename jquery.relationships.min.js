/* http://keith-wood.name/relationships.html
   Relationships for jQuery v2.0.0.
   Written by Keith Wood (kwood{at}iinet.com.au) January 2008.
   Available under the MIT (https://github.com/jquery/jquery/blob/master/MIT-LICENSE.txt) license. 
   Please attribute the author if you use it. */
(function($){var m='relationships';$.JQPlugin.createPlugin({name:m,defaultOptions:{opacity:20,set1:{},set2:{},links:[],description:'',onSelect:null},_descriptionClass:m+'-description',_setClass:m+'-set',_optionsChanged:function(a,b,c){$.extend(b.options,c);a.html(this._generateHTML(b))},_preDestroy:function(a,b){a.empty()},_generateHTML:function(a){return this._addSet(a,1).add(this._addSet(a,2)).add('<div class="'+this._descriptionClass+'">'+a.options.description+'</div>')},_addSet:function(c,d){var f=c.options['set'+d];var g='<div class="'+this._setClass+d+'" style="height: '+f.imageSize[1]+'px;">';for(var i=0;i<f.items.length;i++){g+='<span style="width: '+f.imageSize[0]+'px; '+'height: '+f.imageSize[1]+'px; '+'background: transparent url(\''+f.images+'\') no-repeat '+'-'+((f.items[i].imageIndex||i)*f.imageSize[0])+'px 0px;"></span>'}g=$(g+'</div>');var h=this;g.on('mouseenter','span',function(e){h._showLinks(e.target,d,c)}).on('mouseleave','span',function(e){h._showLinks(e.target,0,c)}).on('click','span',function(e){if($.isFunction(c.options.onSelect)){var a=$(this).index();var b=c.options['set'+d].items[a];c.options.onSelect.apply(c.elem[0],[d,a,b.description||b])}});return g},_showLinks:function(b,c,d){b=$(b);var e=b.index();var f=b.closest('.'+d.name);var g=d.options.description;if(c){var h=d.options['set'+c];g=h.items[e].description||h.items[e];var j=[[],[]];j[c-1]=[e];var k=d.options.links||[];for(var i=0;i<k.length;i++){if(k[i][c-1]===e){j[2-c][j[2-c].length]=k[i][2-c]}}var l=(d.options.opacity||20)/100;f.find('.'+this._setClass+'1 span').css('opacity',function(i,a){return($.inArray(i,j[0])>-1?'1.0':l)});f.find('.'+this._setClass+'2 span').css('opacity',function(i,a){return($.inArray(i,j[1])>-1?'1.0':l)})}else{f.find('span').css('opacity','1.0')}f.find('.'+this._descriptionClass).text(g)}})})(jQuery);